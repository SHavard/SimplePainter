import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.util.ArrayList;

import javax.swing.JPanel;

public class PaintPanel extends JPanel{

	public final static Color BG = Color.BLACK;

	private ArrayList<Segment> segments;

	public PaintPanel() {
		this.setBackground(BG);
		Brush b = new Brush();
		this.addMouseListener(b);
		this.addMouseMotionListener(b);
		segments = new ArrayList<Segment>();
		System.out.println("Panel created");
	}

	private void reset() {
		segments = new ArrayList<Segment>();
		repaint();
		System.out.println("Panel reset");
	}

	public void paintComponent(Graphics g) {
		System.out.println("Painting panel");
		super.paintComponent(g);
		if (segments.size() < 1) {
			System.out.println("<1 segment in panel. Clearing panel");
			g.setColor(BG);
			g.fillRect(0, 0, this.getWidth(), this.getHeight());
		} else if (segments.size() > 1) {
			System.out.println(">1 segment in panel. Drawing segments");
			for (Segment s : segments) {
				s.show(g);
			}
		}
	}

	private void press(MouseEvent e) {
		System.out.println("mouse pressed");
		switch (e.getButton()) {
		case MouseEvent.BUTTON1:
			System.out.println("Button 1");
			//create new segment and add current mouse position to segment
			Segment s = new Segment(new Point(e.getX(), e.getY()));
			break;
		case MouseEvent.BUTTON3:
			System.out.println("Button 3");
			//clear background
			reset();
			break;
		default: 
			//do nothing
			break;
		}
		repaint();
	}
	private void drag(MouseEvent e) {
		System.out.println("mouse dragged");
		System.out.println("Button " + e.getButton() + " dragged");
		if (e.getButton() == MouseEvent.BUTTON1) {
			System.out.println("Button 1 dragged");
			//get most recent segment
			Segment s = segments.get(segments.size() -1);
			//add mouse position to segment
			s.addPoint(new Point(e.getX(), e.getY()));
			repaint();
		}
	}


	private class Brush extends MouseAdapter {

		public void mouseDragged(MouseEvent e) {
			drag(e);
		}

		public void mousePressed(MouseEvent e) {
			press(e);
		}

	}


}
